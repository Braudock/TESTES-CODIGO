import os
from datetime import datetime

# Caminho do diretório principal
base_path = r"\\Fswcorp\ceic\DFEPJ\GAGIRE\22 - CARGA\arquivos_processados"

# Lista os nomes das pastas
pasta_nomes = ['cadastros', 'forcados', 'metas', 'Tombamentos', 'vps']

def listar_pastas_arquivos(base_path):
    for root, dirs, files in os.walk(base_path):
        print(f"\nDiretório: {root}")
        
        # Obtém a data de modificação do diretório
        data_mod_pasta = os.path.getmtime(root)
        data_mod_pasta_formatada = datetime.fromtimestamp(data_mod_pasta).strftime('%Y-%m-%d %H:%M:%S')
        print(f"Data de modificação da pasta: {data_mod_pasta_formatada}")
        
        # Lista subpastas
        for d in dirs:
            subpasta_path = os.path.join(root, d)
            data_mod_subpasta = os.path.getmtime(subpasta_path)
            data_mod_subpasta_formatada = datetime.fromtimestamp(data_mod_subpasta).strftime('%Y-%m-%d %H:%M:%S')
            print(f"  Subpasta: {d} (Modificada em: {data_mod_subpasta_formatada})")
        
        # Lista arquivos
        for f in files:
            arquivo_path = os.path.join(root, f)
            data_mod_arquivo = os.path.getmtime(arquivo_path)
            data_mod_arquivo_formatada = datetime.fromtimestamp(data_mod_arquivo).strftime('%Y-%m-%d %H:%M:%S')
            print(f"  Arquivo: {f} (Modificado em: {data_mod_arquivo_formatada})")

# Executa o código para as pastas especificadas
for pasta in pasta_nomes:
    caminho_completo = os.path.join(base_path, pasta)
    if os.path.exists(caminho_completo):
        listar_pastas_arquivos(caminho_completo)
    else:
        print(f"A pasta {pasta} não existe no caminho fornecido.")