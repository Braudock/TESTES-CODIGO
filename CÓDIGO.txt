import pandas as pd
import saspy

# Configuração da sessão SAS
def connect_to_sas():
    try:
        sas = saspy.SASsession(cfgname='sas_config')  # Substitua 'sas_config' pelo nome correto da sua configuração
        print("SAS session established.")
        return sas
    except Exception as e:
        print(f"Failed to establish SAS session: {e}")
        return None

# Ler o arquivo Excel e transferir para o SAS
def transfer_excel_to_sas(sas_session, filepath, sas_dataset_name, sas_libname):
    try:
        # Ler o arquivo Excel usando pandas
        df = pd.read_excel(filepath)
        print("Excel file read successfully.")

        # Transferir DataFrame do pandas para uma base de dados SAS
        sas_data = sas_session.df2sd(df, table=sas_dataset_name, libref=sas_libname)
        print(f"Data transferred to SAS dataset '{sas_libname}.{sas_dataset_name}' successfully.")
    except Exception as e:
        print(f"Error during transfer to SAS: {e}")

# Configuração do usuário
def main():
    sas_session = connect_to_sas()
    if sas_session:
        filepath = 'caminho_para_seu_arquivo.xlsx'  # Substitua pelo caminho correto do seu arquivo Excel
        sas_dataset_name = 'nome_base_sas'  # Substitua pelo nome desejado para a base de dados no SAS
        sas_libname = 'mylib'  # Substitua pela libname configurada no seu ambiente SAS

 # Transferir dados para o SAS
        transfer_excel_to_sas(sas_session, filepath, sas_dataset_name, sas_libname)

# Executar o script
if __name__ == "__main__":
    main()