import sys
from PyQt5.QtWidgets import QApplication
from PyQt5.QtWebEngineWidgets import QWebEngineView, QWebEnginePage
from PyQt5.QtCore import QUrl
from PyQt5.QtGui import QImage, QPainter

class WebEngine(QWebEngineView):
    def __init__(self):
        super().__init__()

    def capture_page(self, url, caminho_salvar):
        self.load(QUrl(url))
        self.page().loadFinished.connect(lambda: self.screenshot(caminho_salvar))

    def screenshot(self, caminho_salvar):
        image = QImage(self.size(), QImage.Format_ARGB32)
        painter = QPainter(image)
        self.render(painter)
        painter.end()
        image.save(caminho_salvar)
        print(f"Página capturada e salva em: {caminho_salvar}")
        QApplication.quit()

def capturar_pagina(url, caminho_salvar):
    app = QApplication(sys.argv)
    engine = WebEngine()
    engine.capture_page(url, caminho_salvar)
    app.exec_()

# URL e caminho para salvar a imagem
url = "https://exemplo.com"
caminho_salvar = "C:/Users/BRAUD/OneDrive/Área de Trabalho/PASTAS/captura_pagina.png"

capturar_pagina(url, caminho_salvar)