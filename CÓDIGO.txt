import win32com.client

# Criar uma instância do Outlook
outlook = win32com.client.Dispatch("Outlook.Application")

# Acessar o calendário
calendar = outlook.GetNamespace("MAPI").GetDefaultFolder(9)

# Listar os compromissos
appointments = calendar.Items
appointments.IncludeRecurrences = True

# Especificar o período desejado
start_date = "2024-01-01"
end_date = "2024-05-10"

# Filtrar os compromissos pelo período
filtered_appointments = appointments.Restrict("[Start] >= '" + start_date + "' AND [End] <= '" + end_date + "'")

# Exibir os compromissos
print("Compromissos no período de 01 de janeiro de 2024 até 10 de maio de 2024:")
for appointment in filtered_appointments:
    print(f"Data: {appointment.Start}, Assunto: {appointment.Subject}")
