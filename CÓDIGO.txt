pip install openpyxl pyautogui


import pyautogui as pag
import openpyxl
import datetime
import time
import os

# Caminho do arquivo Excel e nome da aba
excel_file_path = 'C:\\caminho\\da\\sua\\planilha.xlsx'
sheet_name = 'NomeDaAba'  # Insira o nome da aba aqui
url = "https://url.do.site"  # Insira a URL do site aqui
save_folder = 'C:\\Users\\BRAUD\\OneDrive\\Área de Trabalho\\PASTAS'

# Abre a planilha
wb = openpyxl.load_workbook(excel_file_path)
sheet = wb[sheet_name]

# Data de hoje
today = datetime.datetime.now().date()

# Função para salvar imagem
def save_image(file_name):
    pag.rightClick()
    time.sleep(1)
    pag.press('v')  # Pressiona 'v' para "Salvar imagem como" no menu do navegador
    time.sleep(1)
    pag.write(os.path.join(save_folder, file_name))
    time.sleep(1)
    pag.press('enter')  # Pressiona Enter para salvar

# Itera sobre as linhas da planilha para verificar aniversariantes
for row in sheet.iter_rows(min_row=2, values_only=True):
    codigo_colaborador, aniversario = row[0], row[4]
    
    # Verifica se a data de aniversário é hoje
    if aniversario and aniversario.date() == today:
        # Abre o navegador e vai para a URL
        os.system(f'start chrome {url}')
        time.sleep(5)  # Espera o navegador abrir
        
        # Digita o código do colaborador nas coordenadas especificadas
        pag.click(x=100, y=200)  # Substitua (x, y) pela posição do campo de texto
        time.sleep(1)
        pag.write(str(codigo_colaborador))
        pag.press('enter')
        time.sleep(3)  # Aguarda a página carregar
        
        # Localiza a imagem nas coordenadas e salva
        pag.click(x=150, y=300)  # Substitua (x, y) pela posição da imagem
        time.sleep(1)
        save_image(f"aniversariante_{codigo_colaborador}.jpg")
        
        # Fecha a aba do navegador
        pag.hotkey('ctrl', 'w')
        time.sleep(1)

print("Processo concluído.")