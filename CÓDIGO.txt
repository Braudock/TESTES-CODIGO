%LET ANOMES = 202310; /* Exemplo de ANOMES */
%LET ANOMESDIA = 20231009; /* Exemplo de ANOMESDIA */

LIBNAME E202410 "/sasusers/gs0312g/workgroup/MENSAL/&ANOMES./";

/* PROC SQL atualizado */
PROC SQL;
CREATE TABLE ALL_DATASETS AS SELECT
    MEMNAME AS NOME_DA_BASE,
    CRDATE AS DATA_ATUALIZACAO,
    NOBS AS NUMERO_DE_LINHAS,
    FILESIZE/1000 AS TAMANHO FORMAT=COMMAX20.,
    CASE 
        WHEN NOBS = 0 THEN 'S/INFO' /* Sem informação */
        ELSE 'C/INFO' /* Com informação */
    END AS STATUS_BASE
FROM DICTIONARY.TABLES
WHERE LIBNAME IN ('OUTCOB', 'INFOCOB', 'OUTDDA', 'EMITIDOS', 'PLANOUT', "E&ANOMES.", "M&ANOMES.")
AND (
    INDEX(UPCASE(MEMNAME), '920_RIK_EVENTOS_CAD_&ANOMESDIA.') > 0
    OR INDEX(UPCASE(MEMNAME), 'TICKET_GERA_IR_&ANOMESDIA.') > 0
    OR INDEX(UPCASE(MEMNAME), 'ACOMP_DE_AUT_EMP_&ANOMESDIA.') > 0
    OR INDEX(UPCASE(MEMNAME), 'LIST_CONS_&ANOMESDIA.') > 0
    OR INDEX(UPCASE(MEMNAME), 'TBOSHEI501_&ANOMESDIA._NOVA') > 0
    OR INDEX(UPCASE(MEMNAME), 'TB_VND_IR3_&ANOMESDIA.') > 0
)
AND MEMNAME NOT CONTAINS 'TBOSHEI501_NOVA_&ANOMESDIA.';
ORDER BY MEMNAME;
QUIT;