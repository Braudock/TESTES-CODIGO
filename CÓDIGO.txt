import win32com.client

# Criar uma instância do Outlook
outlook = win32com.client.Dispatch("Outlook.Application")

# Acessar a caixa de entrada
inbox = outlook.GetNamespace("MAPI").GetDefaultFolder(6)

# Listar os e-mails
emails = inbox.Items

# Especificar o período desejado
start_date = "2024-01-01"
end_date = "2024-05-10"

# Filtrar os e-mails pelo período
filtered_emails = emails.Restrict("[ReceivedTime] >= '" + start_date + "' AND [ReceivedTime] <= '" + end_date + "'")

# Exibir os e-mails
print("E-mails recebidos na caixa de entrada no período de 01 de janeiro de 2024 até 10 de maio de 2024:")
for email in filtered_emails:
    print(f"Assunto: {email.Subject}")
