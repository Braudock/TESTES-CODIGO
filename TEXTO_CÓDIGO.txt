import tkinter as tk
from tkinter import filedialog
import pandas as pd

def select_excel_file():
    # Configurando a janela raiz do Tkinter
    root = tk.Tk()
    root.withdraw()  # Ocultar a janela raiz

    # Abrindo a caixa de diálogo para escolher o arquivo
    file_path = filedialog.askopenfilename(
        title="Selecione o arquivo Excel",
        filetypes=[("Arquivos Excel", "*.xlsx")])
    
    return file_path

def replace_dot_with_comma(file_path):
    # Lendo o arquivo Excel
    df = pd.read_excel(file_path)

    # Substituindo pontos por vírgulas em todas as células que são strings
    df = df.applymap(lambda x: x.replace('.', ',') if isinstance(x, str) else x)

    # Salvando o arquivo modificado
    new_file_path = file_path.replace('.xlsx', '_modified.xlsx')
    df.to_excel(new_file_path, index=False)

    return new_file_path

# Selecionar o arquivo Excel
file_path = select_excel_file()

# Substituir pontos por vírgulas e salvar o arquivo modificado
if file_path:
    new_file_path = replace_dot_with_comma(file_path)
    print("Arquivo modificado salvo em:", new_file_path)
else:
    print("Nenhum arquivo selecionado")
