PROC SQL;
SELECT
    A.NOME_ESPEC,
    A.FUNC_ESPEC,
    A.RACF_ESPEC,
    COUNT(DISTINCT A.SEGMENTO) AS QTD_SEGTO,
    LISTAGG(A.SEGMENTO, ', ') WITHIN GROUP (ORDER BY A.SEGMENTO) AS SEGMENTOS_ATUANDO
FROM
    VALIDA_SEGMENTO AS A
GROUP BY
    A.NOME_ESPEC,
    A.FUNC_ESPEC,
    A.RACF_ESPEC
HAVING
    COUNT(DISTINCT A.SEGMENTO) > 1
;
RUN;
